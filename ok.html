import React, { useState, useEffect } from 'react';
import { Activity, TrendingUp, Calendar, Timer, Target, History } from 'lucide-react';

const App = () => {
const [burpees, setBurpees] = useState(0);
const [duration, setDuration] = useState(0);
const [history, setHistory] = useState(() => {
const saved = localStorage.getItem('burpeeHistory');
return saved ? JSON.parse(saved) : [];
});
const [showHistory, setShowHistory] = useState(false);
const [todayStats, setTodayStats] = useState(null);

// Calculate today's stats
useEffect(() => {
const today = new Date().toDateString();
const todayData = history.find(item => new Date(item.date).toDateString() === today);
if (todayData) {
setTodayStats({
burpees: todayData.burpees,
duration: todayData.duration,
rate: (todayData.burpees / todayData.duration * 60).toFixed(2)
});
} else {
setTodayStats(null);
}
}, [history, burpees, duration]);

// Save to localStorage when history changes
useEffect(() => {
localStorage.setItem('burpeeHistory', JSON.stringify(history));
}, [history]);

const handleSubmit = () => {
if (burpees <= 0 || duration <=0) return; const newEntry={ date: new Date().toISOString(), burpees: burpees, duration:
  duration, rate: (burpees / duration * 60).toFixed(2) // burpees per minute }; setHistory(prev=> [newEntry,
  ...prev.slice(0, 29)]); // Keep last 30 entries
  setBurpees(0);
  setDuration(0);
  };

  const getProgressMessage = () => {
  if (!todayStats) return "No burpees recorded today yet!";

  const allRates = history.map(item => parseFloat(item.rate));
  const avgRate = allRates.length > 0 ? allRates.reduce((a, b) => a + b, 0) / allRates.length : 0;

  if (parseFloat(todayStats.rate) > avgRate * 1.2) {
  return "ðŸ”¥ Amazing improvement! You're crushing it today!";
  } else if (parseFloat(todayStats.rate) > avgRate) {
  return "ðŸ“ˆ Great job! You're performing above your average!";
  } else if (parseFloat(todayStats.rate) >= avgRate * 0.8) {
  return "ðŸ’ª Solid performance! Keep pushing!";
  } else {
  return "ðŸŽ¯ Good start! Aim to beat your average next time!";
  }
  };

  // Calculate stats for chart
  const recentData = history.slice(0, 7).reverse();
  const chartData = recentData.map(item => ({
  date: new Date(item.date).toLocaleDateString('en-US', { weekday: 'short' }),
  burpees: item.burpees,
  rate: parseFloat(item.rate)
  }));

  return (
  <div className="min-h-screen bg-gradient-to-br from-orange-50 to-red-50 p-4">
    <div className="max-w-4xl mx-auto">
      {/* Header */}
      <div className="text-center mb-8">
        <div className="flex items-center justify-center mb-4">
          <Activity className="w-12 h-12 text-orange-600 mr-3" />
          <h1 className="text-4xl font-bold text-gray-800">Burpee Tracker</h1>
        </div>
        <p className="text-gray-600">Track your burpee workouts and see your progress over time</p>
      </div>

      {/* Main Input Card */}
      <div className="bg-white rounded-2xl shadow-xl p-6 mb-6">
        <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
          <div>
            <label className="block text-sm font-medium text-gray-700 mb-2 flex items-center">
              <Target className="w-4 h-4 mr-2 text-orange-500" />
              Burpees Completed
            </label>
            <input type="number" value={burpees} onChange={(e)=> setBurpees(parseInt(e.target.value) || 0)}
            className="w-full p-3 border-2 border-orange-200 rounded-lg focus:border-orange-500 focus:outline-none
            text-lg"
            placeholder="Enter number of burpees"
            min="0"
            />
          </div>

          <div>
            <label className="block text-sm font-medium text-gray-700 mb-2 flex items-center">
              <Timer className="w-4 h-4 mr-2 text-orange-500" />
              Duration (minutes)
            </label>
            <input type="number" value={duration} onChange={(e)=> setDuration(parseFloat(e.target.value) || 0)}
            className="w-full p-3 border-2 border-orange-200 rounded-lg focus:border-orange-500 focus:outline-none
            text-lg"
            placeholder="Enter duration in minutes"
            min="0"
            step="0.1"
            />
          </div>
        </div>

        <button onClick={handleSubmit} disabled={burpees <=0 || duration <=0}
          className="w-full mt-6 bg-gradient-to-r from-orange-500 to-red-500 hover:from-orange-600 hover:to-red-600 disabled:from-gray-300 disabled:to-gray-400 text-white font-bold py-3 px-6 rounded-lg transition-all duration-200 transform hover:scale-105 disabled:scale-100 disabled:cursor-not-allowed">
          Log Workout
        </button>
      </div>

      {/* Today's Stats */}
      {todayStats && (
      <div className="bg-white rounded-2xl shadow-xl p-6 mb-6">
        <div className="flex items-center mb-4">
          <Calendar className="w-5 h-5 text-green-500 mr-2" />
          <h2 className="text-xl font-bold text-gray-800">Today's Performance</h2>
        </div>

        <div className="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
          <div className="bg-green-50 rounded-lg p-4 text-center">
            <div className="text-2xl font-bold text-green-700">{todayStats.burpees}</div>
            <div className="text-sm text-green-600">Total Burpees</div>
          </div>
          <div className="bg-blue-50 rounded-lg p-4 text-center">
            <div className="text-2xl font-bold text-blue-700">{todayStats.duration}m</div>
            <div className="text-sm text-blue-600">Duration</div>
          </div>
          <div className="bg-purple-50 rounded-lg p-4 text-center">
            <div className="text-2xl font-bold text-purple-700">{todayStats.rate}</div>
            <div className="text-sm text-purple-600">Burpees/Minute</div>
          </div>
        </div>

        <div className="bg-yellow-50 rounded-lg p-4">
          <p className="text-yellow-800 font-medium">{getProgressMessage()}</p>
        </div>
      </div>
      )}

      {/* Progress Chart */}
      {chartData.length > 0 && (
      <div className="bg-white rounded-2xl shadow-xl p-6 mb-6">
        <div className="flex items-center mb-4">
          <TrendingUp className="w-5 h-5 text-purple-500 mr-2" />
          <h2 className="text-xl font-bold text-gray-800">Recent Progress (Last 7 Days)</h2>
        </div>

        <div className="overflow-x-auto">
          <div className="flex space-x-4 min-w-max">
            {chartData.map((data, index) => (
            <div key={index} className="flex flex-col items-center min-w-20">
              <div className="text-sm text-gray-600 mb-2">{data.date}</div>
              <div className="w-12 bg-gray-200 rounded-full h-32 flex items-end justify-center">
                <div
                  className="w-8 bg-gradient-to-t from-orange-400 to-orange-600 rounded-t-full transition-all duration-500"
                  style={{ height: `${Math.min(data.rate * 4, 120)}px` }} />
              </div>
              <div className="mt-2 text-sm font-bold text-orange-600">{data.rate}</div>
            </div>
            ))}
          </div>
          <div className="text-center text-sm text-gray-500 mt-2">Burpees per minute</div>
        </div>
      </div>
      )}

      {/* History Toggle */}
      <div className="text-center mb-6">
        <button onClick={()=> setShowHistory(!showHistory)}
          className="flex items-center mx-auto bg-white border-2 border-orange-200 text-orange-600 hover:bg-orange-50
          font-medium py-2 px-4 rounded-lg transition-colors"
          >
          <History className="w-4 h-4 mr-2" />
          {showHistory ? 'Hide History' : 'Show History'}
        </button>
      </div>

      {/* History */}
      {showHistory && history.length > 0 && (
      <div className="bg-white rounded-2xl shadow-xl p-6">
        <h2 className="text-xl font-bold text-gray-800 mb-4">Workout History</h2>
        <div className="space-y-3 max-h-96 overflow-y-auto">
          {history.map((entry, index) => (
          <div key={index} className="flex justify-between items-center p-3 bg-gray-50 rounded-lg">
            <div>
              <div className="font-medium text-gray-800">
                {new Date(entry.date).toLocaleDateString('en-US', {
                month: 'short',
                day: 'numeric',
                year: 'numeric'
                })}
              </div>
              <div className="text-sm text-gray-600">
                {entry.burpees} burpees in {entry.duration}m
              </div>
            </div>
            <div className="text-right">
              <div className="font-bold text-orange-600">{entry.rate}</div>
              <div className="text-xs text-gray-500">burpees/min</div>
            </div>
          </div>
          ))}
        </div>
      </div>
      )}
    </div>
  </div>
  );
  };

  export default App;